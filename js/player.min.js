function check_isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function supports_video(){return!!document.createElement("video").canPlayType}function supports_audio(){var n=document.createElement("audio");return!!(n.canPlayType&&n.canPlayType("audio/mpeg;").replace(/no/,""))}function onSilverlightError(n,t){var u="",r,f,i;(n!=null&&n!=0&&(u=n.getHost().Source),r=t.ErrorType,f=t.ErrorCode,r!="ImageError"&&r!="MediaError")&&(i="Silverlight 應用程式中有未處理的錯誤 "+u+"\n",i+="代碼: "+f+"    \n",i+="分類: "+r+"       \n",i+="訊息: "+t.ErrorMessage+"     \n",r=="ParserError"?(i+="檔案: "+t.xamlFile+"     \n",i+="行: "+t.lineNumber+"     \n",i+="位置: "+t.charPosition+"     \n"):r=="RuntimeError"&&(t.lineNumber!=0&&(i+="行: "+t.lineNumber+"     \n",i+="位置: "+t.charPosition+"     \n"),i+="方法名稱: "+t.methodName+"     \n"),console.log(i))}function onSilverlightLoad(n,t){mediaPlayerReady=!0;var i=t;i.onPlayEnded?n.Content.Player.SetPlayEndedCallBack(i.onPlayEnded):n.Content.Player.SetPlayEndedCallBack(function(n){n||alert("無法連接影片")});i.onTimelineChanged&&n.Content.Player.SetTimelineChagnedCallBack(i.onTimelineChanged);i.onMarkerReached&&n.Content.Player.SetMarkerReachedCallBack(i.onMarkerReached);i.onLoaded&&i.onLoaded()}function StartAjax(n,t,i,r){if(typeof jQuery=="undefined")throw"jQuery Not Found";$.ajax({type:"post",async:r==undefined?!0:r,contentType:"application/json; charset=utf-8",url:elearningService+n,data:JSON.stringify(t),dataType:"json",success:function(n){var t=JSON.parse(n.d);i!=undefined&&i(t)},error:function(n){var t=JSON.stringify(n),i=JSON.parse(t),r=JSON.parse(i.responseText);alert(r.Message)}})}var mediaPlayerReady=!1,elearningService;$(document).ready(function(){}),function(n){var i={autoPlay:!0,mediaSource:"",thumbSource:"",learnerMark:!0,sourceType:"course",onLoaded:!1,onPlayEnded:!1,onTimelineChanged:!1,onMarkerReached:!1},t;n.fn.htmlPlayer=function(t){var u=n.extend(i,t),r;if(this.length==1)return!supports_video()||!supports_audio()?(alert("您的瀏覽器不支援 HTML 5 影音播放標記"),this):(u.mediaSource.toString().toUpperCase().indexOf(".MP3")!=-1?r=document.createElement("audio"):(r=document.createElement("video"),n.trim(u.thumbSource)!=""&&r.setAttribute("poster",u.thumbSource),r.setAttribute("style","width:100%;")),u.mediaSource=u.mediaSource.replace("ism/Manifest","mp4"),r.setAttribute("id","videoPlayer"),r.setAttribute("controls","controls"),u.mediaSource!=""&&r.setAttribute("src",u.mediaSource),u.autoPlay&&r.setAttribute("autoplay","autoplay"),r.addEventListener("contextmenu",function(n){return n.preventDefault(),!1}),r.addEventListener("ended",function(){u.playEnded(!0)}),r.addEventListener("error",function(){return alert("無法連接影片"),!1}),r.addEventListener("canplay",function(){this.play()}),window.addEventListener("blur",function(){r.pause()}),this.empty(),this.append(r),n(r))};n.fn.smoothplayer=function(t){var f,r,e,o,u;return this.length!=1?this:(f=this,r=n.extend(i,t),n.trim(r.mediaSource)!=""&&r.mediaSource.toLowerCase().indexOf(".ism/manifest")==-1&&r.mediaSource.toLowerCase().indexOf(".mp4")==-1&&r.mediaSource.toLowerCase().indexOf(".mp3")==-1&&(r.mediaSource+=".ism/Manifest"),e="mediaSource="+r.mediaSource+",autoPlay="+r.autoPlay.toString()+",thumbSource="+r.thumbSource+",learnerMark="+r.learnerMark,e+=",sourceType="+r.sourceType,o=Silverlight.createObjectEx({source:"ClientBin/MediaPlayer.xap?v=20140409",parentElement:null,id:"videoPlayer",properties:{width:"100%",height:"100%",version:"5.0.60401.0",autoUpgrade:"true",windowless:"true"},events:{onError:onSilverlightError,onLoad:onSilverlightLoad},initParams:e,context:r}),u=n(o),f.empty(),f.append(u),document.onfocusout=function(t){var r,i;t===undefined&&(r=event,r.toElement==null&&!!u.length&&mediaPlayerReady&&(u[0].Content.Player.GetFullScreen()||(i=u.getCurrentState().toLowerCase(),i!="paused"&&i!="stopped"&&i!=""&&(u.videoControl("pause"),n(".player-message").find(".text").text("影片已暫停播放，是否繼續觀看?").end().show()))))},window.onblur=function(t){if(t!==undefined&&!!u.length&&mediaPlayerReady&&!u[0].Content.Player.GetFullScreen()){var i=u.getCurrentState().toLowerCase();i!="paused"&&i!="stopped"&&i!=""&&(u.videoControl("pause"),n(".player-message").find(".text").text("影片已暫停播放，是否繼續觀看?").end().show())}},u)};n.fn.mediaplayer=function(n){return check_isMobile()?this.htmlPlayer(n):this.smoothplayer(n)};n.fn.setPosition=function(n,t){var r=this,i=r[0];return i.Content==null?i.currentTime=n:i.Content.Player.SetVideoPosition(n,t),r};n.fn.getTotalSeconds=function(){var i=this,n=i[0],t=0;return n.Content==null||(t=n.Content.Player.GetVideoTotalSeconds()),t};n.fn.getPosition=function(){var t=this,n=t[0];return n.Content==null?n.currentTime:n.Content.Player.GetVideoPosition()};n.fn.getCurrentState=function(){var t=this,n=t.get(0);return n.Content==null?n.paused===!0?"paused":"playing":n.Content.Player.GetCurrentState()};n.fn.setMarker=function(n){var i=this,t=i[0];return t.Content==null?t.addEventListener("timeupdate",function(){}):t.Content.Player.SetMarker(JSON.stringify(n)),0};n.fn.addMarker=function(n){var i=this,t=i[0];return t.Content==null||t.Content.Player.AddMarker(JSON.stringify(n)),this};n.fn.modifyMarker=function(n){var i=this,t=i.get(0);return t.Content==null||t.Content.Player.ModifyMarker(n.Data_No,n.Marker_Text,n.Marker_Position,n.Marker_Duration),this};n.fn.deleteMarker=function(n){var i=this,t=i[0];return t.Content==null||t.Content.Player.DeleteMarker(n),this};n.fn.videoControl=function(n){var t=this,i=t[0];return i.Content==null||i.Content.Player.VideoControl(n),t};n.fn.setSource=function(t){var i=this,u=i.get(0),f,r;if(t=n.extend({learnerMark:!0},t),f="GetMediaSource",r={Source_Type:t.sourceType,Mobile_Mark:!0,Learner_Mark:t.learnerMark},t.dataNo?(r.Data_No=t.dataNo,f+="2"):r.Video_Id=t.videoId,u.Content){if(!mediaPlayerReady){alert("請等待播放器載入完畢");return}r.Mobile_Mark=!1}return StartAjax(f,r,function(r){var e,f,o;if(r.Success_Mark){if(e=r.Response_Data,f=e.MediaSource,u.Content?(o=e.Last_Video_Position,u.Content.Player.SetMediaSource(f,o,e.autoPlay)):(f.toString().toUpperCase().indexOf(".MP3")!=-1?i.prop("tagName")=="video"&&(i=n("#mediaPlayer").mediaplayer({mediaSource:f})):(i.prop("tagName")=="audio"&&(i=n("#mediaPlayer").mediaplayer({mediaSource:f})),i.attr("poster",f.replace(".mp4","_Thumb.jpg"))),i.attr("src",f),i.attr("autoplay","autoplay")),t.onComplete!=undefined)t.onComplete(e)}else r.Display_Message!=""&&alert(r.Display_Message)}),i};n.fn.setCourseSettings=function(n){if(this.length)return(n.courseNo=null)?void 0:(this[0].Content.Player.SetCourseSetting(n.courseNo),this)};t=null;n.progress={showLoading:function(t,i){i&&n.trim(i)!=""||(i="資料處理中...");var r=n('<div class="loading"><div class="overlay"><\/div><div class="message"><img src="css/images/ajax-loader-snack.gif" alt="Loading..." />'+i+"<\/div><\/div>");r.appendTo(document.body)},showSuccess:function(i,r){r&&n.trim(r)!=""||(r="設定完成");var u=n('<div class="progress-message"><\/div>');t!=null&&(n(".progress-message").remove(),clearTimeout(t));u.text(r).hide().appendTo(document.body);u.fadeIn();t=setTimeout(function(){u.fadeOut(function(){u.remove()})},i)}}}(jQuery);elearningService="/L000_Service/ElearningService.asmx/";String.prototype.toHHMMSS=function(n){var e=0,f;this.indexOf(".")!=-1&&(e=this.split(".")[1]);var u=parseInt(this,10),t=Math.floor(u/3600),i=Math.floor((u-t*3600)/60),r=u-t*3600-i*60;return t<10&&(t="0"+t),i<10&&(i="0"+i),r<10&&(r="0"+r),f=t+":"+i+":"+r,n&&n.showFullTime===!0&&(f+="."+e.toString().substr(0,1)),f};
/*
//# sourceMappingURL=player.min.js.map
*/